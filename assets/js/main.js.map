{"version":3,"sources":["../../_javascript/internalLink.js","../../_javascript/main.js","../../_javascript/accordionMenu.js","../../_javascript/switchAppearance.js","../../_javascript/servicesView.js","../../_javascript/lightBox.js"],"names":["internalLink","$navLink","itemsOfToc","createToc","console","log","tocContainer","document","getElementById","headings","querySelector","querySelectorAll","outline","currentNode","i","length","currentHeading","tagName","push","namedAnchor","setAttribute","name","getAttribute","textContent","replace","anchor","createElement","appendChild","id","classList","add","innerHTML","map","item","createItemOfToc","undefined","nodeName","subitem","join","$","each","index","elm","target","dataset","rect","y","height","updateHighlightingOfToc","screenTop","window","scrollY","intersect","innerHeight","remove","rect1","rect2","sy","Math","max","h","min","on","promise","Promise","resolve","reject","then","container","offsetTop","clientHeight","updateSectionSize","param","location","hash","match","slice","scrollIntoView","behavior","inline","history","replaceState","this","href","animate","scrollTop","attr","offset","top","substr","catch","error","onload","next","slideToggle","toggleClass","click","parent","prev","removeClass","appearanceWwitch","buttons","forEach","button","addEventListener","e","parentNode","appearanceType","appearanceValue","switchAppearance","servicesView_","_step","categoryTags","affiliationTags","services","_iterator","_createForOfIteratorHelper","s","n","done","_step3","service","value","_iterator3","tag","array","contains","err","f","html","facetSearchTags","Object","keys","concat","selectedTags","$selectedTags","indexOf","splice","_step2","_iterator2","isHidden","tags","Array","from","_i","_tags","servicesView","ready","colorbox","rel","maxWidth","maxHeight","current","opacity"],"mappings":"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","sourcesContent":["/* global $ */\n\n// 内部リンク\nexport default function internalLink() {\n  let $navLink = '';\n  let itemsOfToc = [];\n\n  function createToc() {\n    console.log('createToc')\n    const tocContainer = document.getElementById('TableOfContents');\n    if (tocContainer) {\n      const postContent = document.querySelector('.md-content');\n      const headings = postContent.querySelectorAll('h2, h3, h4');\n      const outline = [];\n      let currentNode = outline;\n      for (let i = 0; i < headings.length; i++) {\n        const currentHeading = headings[i];\n        // make outline\n        switch (currentHeading.tagName) {\n          case 'H2':\n            currentNode = [];\n            outline.push(currentHeading, currentNode);\n            break;\n          case 'H3':\n            currentNode.push(currentHeading);\n            break;\n        }\n        // add ID\n        const namedAnchor = currentHeading.querySelector('a[name]');\n        if (namedAnchor) {\n          // 見出しにname属性持ちのアンカーがあれば、name属性をIDに \n          currentHeading.setAttribute('id', namedAnchor.name);\n        } else if (!currentHeading.getAttribute('id')) {\n          // そうでなく、かつ見出しにIDが付与されていなければ、見出し内容をIDに\n          // （ただしどうやらJekyllは自動的にそれをやっているっぽい。だとしたら不要\n          // * encodeURIComponent は不要？\n          currentHeading.setAttribute('id', currentHeading.textContent.replace(/[\\/\\s]/g, '-'));\n        }\n        // add anchor\n        if (currentHeading.tagName === 'H2' || currentHeading.tagName === 'H3') {\n          const anchor = document.createElement('a');\n          currentHeading.appendChild(anchor);\n          anchor.setAttribute('href', '#' + currentHeading.id);\n          anchor.classList.add('link-icon');\n        }\n      }\n      // make table of content\n      tocContainer.innerHTML = '<ul>' + outline.map(item => createItemOfToc(item)).join('').replace(/<li><ul><\\/ul><\\/li>/g, '').replace(/<\\/li><li><ul><\\/ul>/g, '<ul>') + '</ul>';\n    }\n    $('a', tocContainer).each((index, item) => {\n      itemsOfToc.push({\n        elm: item,\n        target: document.getElementById(item.dataset.target),\n        rect: { y: undefined, height: undefined }\n      })\n    });\n    $navLink = $('#TableOfContents li a');\n  }\n\n  function createItemOfToc(item) {\n    switch (true) {\n      case item.nodeName !== undefined:\n        return '<li><a href=\"#' + item.id + '\" data-target=\"' + item.id + '\">' + item.textContent + '</a></li>';\n      case item.length !== undefined:\n        return '<li><ul>' + item.map(subitem => createItemOfToc(subitem)).join('') + '</ul></li>';\n    }\n  }\n\n  // セクションの矩形サイズを更新\n  function updateSectionSize() {\n    const container = document.querySelector('#MainContentView > .md-content');\n    for (let i = 0; i < itemsOfToc.length; i++) {\n      const item = itemsOfToc[i];\n      item.rect.y = item.target.offsetTop;\n      item.rect.height = (i < itemsOfToc.length - 1 ? itemsOfToc[i + 1].target.offsetTop : container.offsetTop + container.clientHeight) - item.rect.y;\n    }\n  }\n\n  // 目次のハイライトを更新\n  function updateHighlightingOfToc() {\n    const screenTop = window.scrollY;\n    for (let i = 0; i < itemsOfToc.length; i++) {\n      const item = itemsOfToc[i];\n      const rect = intersect({y: screenTop, height: window.innerHeight}, item.rect);\n      if (rect.height > 0) {\n        item.elm.classList.add('current');\n      } else {\n        item.elm.classList.remove('current');\n      }\n    }\n  }\n\n  function intersect(rect1, rect2) {\n    const\n      sy = Math.max(rect1.y, rect2.y),\n      ey = Math.min(rect1.y + rect1.height, rect2.y + rect2.height),\n      h = ey - sy;\n    if (h > 0) {\n      return { y: sy, height: h };\n    }\n    return { y: 0, height: 0 };\n  }\n\n  // ページ読み込み時とスクロール時に、現在地をチェックする\n  $(window).on(\"scroll\", function () {\n    updateHighlightingOfToc();\n  });\n\n  // ナビゲーションクリック時の動作：スムーズスクロール・アドレスバーにID付与\n  const smoothScroll = () => {\n    $navLink.on(\"click\", function () {\n      history.replaceState('', '', this.href);\n      $(\"html,body\").animate(\n        {\n          scrollTop: $($(this).attr(\"href\")).offset().top - 24,\n        },\n        400\n      );\n      return false;\n    });\n  };\n\n  console.log('before of promise1')\n  let promise = new Promise((resolve, reject) => {\n    createToc();\n    console.log('before of resolve')\n    resolve();\n  });\n\n  console.log('before of promise2')\n  promise\n    .then(() => {\n      updateSectionSize();\n      updateHighlightingOfToc();\n    }).then(() => {\n      console.log(\"パラメーター確認開始\");\n      // URLパラメータ文字列を取得\n      let param = location.hash;\n      // 変数paramに#がついていれば\n      if (param.match('#')) {\n        // その#の位置に移動\n        let element = document.getElementById(param.slice(1));\n        element.scrollIntoView({\n          behavior: \"smooth\",\n          inline: \"nearest\",\n        });\n      }\n    }).then(() => {\n      smoothScroll();\n      // hashを調べる\n      const hash = window.location.hash.substr(1);\n      // hashがあれば、スクロール\n    }).catch((error) => {\n      // エラーハンドリング\n      console.error(error);\n    });\n    \n}\n","import internalLink from \"./internalLink\"\nimport accordionMenu from \"./accordionMenu\"\nimport switchAppearance from \"./switchAppearance\"\nimport servicesView from \"./servicesView\"\nimport lightBox from \"./lightBox\"\nwindow.onload = function () {\n\n  // 内部リンク\n  internalLink();\n  // アコーディオンメニュー\n  accordionMenu();\n  // 外観変更スイッチ\n  switchAppearance();\n  // サービス一覧\n  servicesView();\n  // ライトボックス\n  lightBox();\n\n}\n","// アコーディオンメニュー\nexport default function accordionMenu() {\n  $('.toggle-content-btn').on('click', function () {\n    const content = $(this).next('.accordion-content')\n    content.slideToggle(500)\n    $(this).toggleClass(\"active\");\n  });\n\n  $('.close-content-btn').click(function () {\n    const content = $(this).parent().parent()\n    content.slideToggle(500)\n    $(this).parent().parent().prev().removeClass(\"active\");\n  });\n}","// 外観変更スイッチ\nexport default function switchAppearance() {\n  const appearanceWwitch = document.querySelector('.appearance-switch');\n  if (appearanceWwitch) {\n    const buttons = appearanceWwitch.querySelectorAll('.button');\n    buttons.forEach(button => {\n      button.addEventListener('click', e => {\n        appearanceWwitch.parentNode.dataset.appearanceType = e.target.dataset.appearanceValue;\n        // ボタンのハイライト切替\n        buttons.forEach(button => {\n          if (button === e.target) {\n            button.classList.add('-current');\n          } else {\n            button.classList.remove('-current');\n          }\n        });\n      });\n    });\n  }\n}","/* global $ */\n\n// サービス一覧\nexport default function servicesView() {\n  const servicesView_ = document.getElementById('ServicesView');\n  if (servicesView_) {\n    // タグの収集\n    const categoryTags = {}, affiliationTags = {};\n    const services = servicesView_.querySelectorAll('.service')\n    for (const service of services) {\n      const tags = service.querySelectorAll('.tags > .service-tag');\n      for (const tag of tags) {\n        let array;\n        if (tag.classList.contains('-reverse')) {\n          // 所属\n          array = affiliationTags;\n        } else {\n          // カテゴリ\n          array = categoryTags;\n        }\n        if (!array[tag.dataset.tag]) {\n          array[tag.dataset.tag] = [];\n        }\n        array[tag.dataset.tag].push(service);\n      }\n    }\n    // ファセット検索用ビューの生成\n    let html = '';\n    const facetSearchTags = document.querySelector('.facet-search > .tags');\n    html += Object.keys(categoryTags).map(tag => `<li class=\"service-tag\" data-tag=\"${tag}\">${tag}<span class=\"count\">${categoryTags[tag].length}</span></li>`).join('');\n    html += Object.keys(affiliationTags).map(tag => `<li class=\"service-tag -reverse\" data-tag=\"${tag}\">${tag}<span class=\"count\">${affiliationTags[tag].length}</span></li>`).join('');\n    facetSearchTags.innerHTML = html;\n    // インタラクション\n    const selectedTags = [];\n    const $selectedTags = $('.service-tag', facetSearchTags);\n    $selectedTags.on('click', e => {\n      const tag = e.target.dataset.tag;\n      // 選択中のタグに追加・削除\n      if (selectedTags.indexOf(tag) === -1) {\n        selectedTags.push(tag);\n      } else {\n        selectedTags.splice(selectedTags.indexOf(tag), 1);\n      }\n      if (selectedTags.length) {\n        // 何か選択されている場合、選択されているもののみ表示\n        $selectedTags.each((index, elm) => {\n          if (selectedTags.indexOf(elm.dataset.tag) === -1) {\n            elm.classList.add('-disable');\n          } else {\n            elm.classList.remove('-disable');\n          }\n        });\n        for (const service of services) {\n          let isHidden = true;\n          const tags = Array.from(service.querySelectorAll('.tags > .service-tag'), tag => tag.dataset.tag);\n          for (const tag of tags) {\n            if (selectedTags.indexOf(tag) !== -1) {\n              isHidden = false;\n              break;\n            }\n          }\n          if (isHidden) {\n            service.classList.add('-hidden');\n          } else {\n            service.classList.remove('-hidden');\n          }\n        }\n      } else {\n        // 無選択の場合、全部選択\n        $selectedTags.each((index, elm) => elm.classList.remove('-disable'));\n        services.forEach(service => service.classList.remove('-hidden'));\n      }\n    });\n\n  }\n}","// ライトボックス\nexport default function lightBox() {\n  $(document).ready(function () {\n    $(\".group1\").colorbox({ rel: 'group1', maxWidth: \"90%\", maxHeight: \"90%\", current: '{current} / {total}', opacity: 1 });\n  });\n\n}\n"]}